<!doctype html><html lang=en><head><title>KQL Notes</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/application.650f674fc19266f4ea6c7b54bb6a4ffad10dfa641e3bea6de0a8472a99807590.css integrity="sha256-ZQ9nT8GSZvTqbHtUu2pP+tEN+mQeO+pt4KhHKpmAdZA="><link rel=icon type=image/png href=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png><meta property="og:title" content="KQL Notes"><meta property="og:description" content="KQL Notes https://detective.kusto.io/inbox
Season 2 - Case 0 - Onboarding //Case 0 training DetectiveCases | where EventType == 'CaseOpened' | extend Bounty = toreal(Properties.Bounty) | count DetectiveCases | where EventType == 'CaseSolved' | summarize CasesSolved=count() by DetectiveId //| count | top 10 by CasesSolved DetectiveCases | where EventType == 'CaseOpened' | project CaseOpened = Timestamp, CaseId | join kind=inner ( DetectiveCases | where EventType == 'CaseAssigned' | summarize FirstAssigned=min(Timestamp) by CaseId) on CaseId | summarize Average=avg(FirstAssigned - CaseOpened) DetectiveCases | where EventType == 'CaseOpened' | project CaseOpened = Timestamp, CaseId | join kind=inner ( DetectiveCases | where EventType == 'CaseSolved' | summarize CaseSolved=min(Timestamp) by CaseId) on CaseId | summarize Average=avg(CaseSolved - CaseOpened) DetectiveCases | where EventType == 'CaseOpened' | project CaseOpened=Timestamp, CaseId | join kind=inner ( DetectiveCases | where EventType == 'CaseSolved' | summarize CaseSolved=min(Timestamp) by CaseId ) on CaseId | summarize avg(CaseSolved - CaseOpened) //Case 0 Solved DetectiveCases | where Timestamp >= datetime(2022-01-01) and Timestamp < datetime(2023-01-01) | where EventType == &#34;CaseOpened&#34; and isnotnull(Properties."><meta property="og:type" content="article"><meta property="og:url" content="https://www.mjh3.com/notes/kql/"><meta property="article:section" content="notes"><meta name=twitter:card content="summary"><meta name=twitter:title content="KQL Notes"><meta name=twitter:description content="KQL Notes https://detective.kusto.io/inbox
Season 2 - Case 0 - Onboarding //Case 0 training DetectiveCases | where EventType == 'CaseOpened' | extend Bounty = toreal(Properties.Bounty) | count DetectiveCases | where EventType == 'CaseSolved' | summarize CasesSolved=count() by DetectiveId //| count | top 10 by CasesSolved DetectiveCases | where EventType == 'CaseOpened' | project CaseOpened = Timestamp, CaseId | join kind=inner ( DetectiveCases | where EventType == 'CaseAssigned' | summarize FirstAssigned=min(Timestamp) by CaseId) on CaseId | summarize Average=avg(FirstAssigned - CaseOpened) DetectiveCases | where EventType == 'CaseOpened' | project CaseOpened = Timestamp, CaseId | join kind=inner ( DetectiveCases | where EventType == 'CaseSolved' | summarize CaseSolved=min(Timestamp) by CaseId) on CaseId | summarize Average=avg(CaseSolved - CaseOpened) DetectiveCases | where EventType == 'CaseOpened' | project CaseOpened=Timestamp, CaseId | join kind=inner ( DetectiveCases | where EventType == 'CaseSolved' | summarize CaseSolved=min(Timestamp) by CaseId ) on CaseId | summarize avg(CaseSolved - CaseOpened) //Case 0 Solved DetectiveCases | where Timestamp >= datetime(2022-01-01) and Timestamp < datetime(2023-01-01) | where EventType == &#34;CaseOpened&#34; and isnotnull(Properties."></head><body class="type-notes kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png alt=Logo>
Maron's Site</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/notes data-filter=all>Notes</a></li><div class=subtree><li><a class=active href=/notes/kql/ title=KQL>KQL</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class="content container-fluid" id=content><div class="container-fluid note-card-holder" id=note-card-holder><h1 id=kql-notes>KQL Notes</h1><p><a href=https://detective.kusto.io/inbox target=_blank rel=noopener>https://detective.kusto.io/inbox</a></p><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 0 - Onboarding</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>0</span> training
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend Bounty <span style=color:#f92672>=</span> toreal(Properties.Bounty)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseSolved&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize CasesSolved<span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> DetectiveId
</span></span><span style=display:flex><span><span style=color:#f92672>//|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> CasesSolved
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseOpened <span style=color:#f92672>=</span> <span style=color:#66d9ef>Timestamp</span>, CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> 
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseAssigned&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize FirstAssigned<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(<span style=color:#66d9ef>Timestamp</span>) <span style=color:#66d9ef>by</span> CaseId)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Average<span style=color:#f92672>=</span><span style=color:#66d9ef>avg</span>(FirstAssigned <span style=color:#f92672>-</span> CaseOpened)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseOpened <span style=color:#f92672>=</span> <span style=color:#66d9ef>Timestamp</span>, CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> 
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseSolved&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize CaseSolved<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(<span style=color:#66d9ef>Timestamp</span>) <span style=color:#66d9ef>by</span> CaseId)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Average<span style=color:#f92672>=</span><span style=color:#66d9ef>avg</span>(CaseSolved <span style=color:#f92672>-</span> CaseOpened)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseOpened<span style=color:#f92672>=</span><span style=color:#66d9ef>Timestamp</span>, CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseSolved&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize CaseSolved<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(<span style=color:#66d9ef>Timestamp</span>) <span style=color:#66d9ef>by</span> CaseId
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>avg</span>(CaseSolved <span style=color:#f92672>-</span> CaseOpened)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>0</span> Solved
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>Timestamp</span> <span style=color:#f92672>&gt;=</span> datetime(<span style=color:#ae81ff>2022</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span>) <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>Timestamp</span> <span style=color:#f92672>&lt;</span> datetime(<span style=color:#ae81ff>2023</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;CaseOpened&#34;</span> <span style=color:#66d9ef>and</span> isnotnull(Properties.Bounty) <span style=color:#66d9ef>and</span> isnotnull(CaseId)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseId, Bounty <span style=color:#f92672>=</span> todouble(parse_json(Properties).Bounty)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;CaseAssigned&#34;</span> <span style=color:#66d9ef>and</span> isnotnull(DetectiveId) <span style=color:#66d9ef>and</span> isnotnull(CaseId)
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> project CaseId, DetectiveId
</span></span><span style=display:flex><span>) <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize TotalEarnings <span style=color:#f92672>=</span> <span style=color:#66d9ef>sum</span>(Bounty) <span style=color:#66d9ef>by</span> DetectiveId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> TotalEarnings <span style=color:#66d9ef>desc</span>
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 1 - To bill or not to bill?</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>1</span> training
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>can run <span style=color:#66d9ef>sql</span> directly
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>SUM</span>(Consumed <span style=color:#f92672>*</span> Cost) <span style=color:#66d9ef>AS</span> TotalCost 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Costs 
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> Consumption <span style=color:#66d9ef>ON</span> Costs.MeterType <span style=color:#f92672>=</span> Consumption.MeterType 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>can use <span style=color:#66d9ef>EXPLAIN</span> <span style=color:#66d9ef>to</span> <span style=color:#66d9ef>convert</span> <span style=color:#66d9ef>to</span> KQL
</span></span><span style=display:flex><span><span style=color:#66d9ef>EXPLAIN</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>SUM</span>(Consumed <span style=color:#f92672>*</span> Cost) <span style=color:#66d9ef>AS</span> TotalCost 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Costs 
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> Consumption <span style=color:#66d9ef>ON</span> Costs.MeterType <span style=color:#f92672>=</span> Consumption.MeterType 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>EXPLAIN</span>
</span></span><span style=display:flex><span>Costs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> 
</span></span><span style=display:flex><span>(Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project<span style=color:#f92672>-</span><span style=color:#66d9ef>rename</span> [<span style=color:#e6db74>&#39;Consumption.MeterType&#39;</span>]<span style=color:#f92672>=</span>MeterType) <span style=color:#66d9ef>on</span> ([<span style=color:#e6db74>&#39;$left&#39;</span>].MeterType <span style=color:#f92672>==</span> [<span style=color:#e6db74>&#39;$right&#39;</span>].[<span style=color:#e6db74>&#39;Consumption.MeterType&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize TotalCost<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(__sql_multiply(Consumed, Cost))
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project TotalCost
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>cleaned up a bit USES LOOKUP
</span></span><span style=display:flex><span>Consumption  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> summarize TotalConsumed <span style=color:#f92672>=</span> <span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> MeterType  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> lookup Costs <span style=color:#66d9ef>on</span> MeterType  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> extend TotalCost <span style=color:#f92672>=</span> TotalConsumed<span style=color:#f92672>*</span>Cost  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>sum</span>(TotalCost) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> who used the most water
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Water&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>summarize WaterWaster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> HouseholdId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> WaterWaster
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>who used the most electricity
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Electricity&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize ElectricityWaster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> HouseholdId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> ElectricityWaster
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Water consumption <span style=color:#66d9ef>by</span> date <span style=color:#66d9ef>Timestamp</span>
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Water&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize WaterWaster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>d)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> render timechart 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Electricity <span style=color:#66d9ef>by</span> date
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Electricity&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Elec_Waster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>d)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> render timechart 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Elec stats <span style=color:#66d9ef>like</span> <span style=color:#66d9ef>min</span> <span style=color:#66d9ef>max</span> <span style=color:#66d9ef>count</span> <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>avg</span>
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span><span style=color:#e6db74>&#34;Electricity&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Total_Count<span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>(), Lowest_Value<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(Consumed), Highest_Value<span style=color:#f92672>=</span><span style=color:#66d9ef>max</span>(Consumed), Average_Value<span style=color:#f92672>=</span><span style=color:#66d9ef>avg</span>(Consumed)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> Solved
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize hint.strategy<span style=color:#f92672>=</span>shuffle arg_max(Consumed, <span style=color:#f92672>*</span>) <span style=color:#66d9ef>by</span> HouseholdId, MeterType, <span style=color:#66d9ef>Timestamp</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> (
</span></span><span style=display:flex><span>    Costs
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> project MeterType, Cost
</span></span><span style=display:flex><span>) <span style=color:#66d9ef>on</span> MeterType
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend BillAmount <span style=color:#f92672>=</span> Consumed <span style=color:#f92672>*</span> Cost
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize TotalBillsAmount <span style=color:#f92672>=</span> <span style=color:#66d9ef>sum</span>(BillAmount)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>using</span> lookup <span style=color:#66d9ef>function</span>
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize hint.strategy<span style=color:#f92672>=</span>shuffle arg_max(Consumed, <span style=color:#f92672>*</span>) <span style=color:#66d9ef>by</span> HouseholdId, MeterType, <span style=color:#66d9ef>Timestamp</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> lookup Costs <span style=color:#66d9ef>on</span> MeterType
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>sum</span>(Consumed <span style=color:#f92672>*</span> Cost)
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Kusto Detective KQL Challenge Information</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span>Welcome <span style=color:#66d9ef>to</span> the Kusto Detective Agency <span style=color:#f92672>-</span> Season <span style=color:#ae81ff>2</span><span style=color:#f92672>!</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>If</span> you<span style=color:#e6db74>&#39;ve been here before, congrats on leveling up! Click that log-in button to access your account.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>But if you&#39;</span>re <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>and</span> don<span style=color:#e6db74>&#39;t have a free Kusto cluster or KQL database, fear not! Follow the instructions in the FAQ section to create one and join the detective party. Your shiny new cluster will be your go-to investigative tool, and its URL will be your secret agent identity.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>If you have been here for Season 1, you may be surprised to find yourself as a Rookie again. You see, it&#39;</span>s <span style=color:#66d9ef>all</span> about innovation <span style=color:#66d9ef>and</span> hitting refresh. So, it<span style=color:#e6db74>&#39;s a fresh start for everyone. Yet we believe in excellence and that&#39;</span>s why we need your detective skills <span style=color:#66d9ef>to</span> unveil the cr<span style=color:#960050;background-color:#1e0010>è</span>me de la cr<span style=color:#960050;background-color:#1e0010>è</span>me <span style=color:#66d9ef>of</span> detectives <span style=color:#66d9ef>from</span> the past <span style=color:#66d9ef>year</span>, <span style=color:#ae81ff>2022</span>. This <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>like</span> the ultimate leaderboard challenge <span style=color:#66d9ef>where</span> we crown the <span style=color:#e6db74>&#34;Most Epic Detective of the Year.&#34;</span> Exciting, <span style=color:#66d9ef>right</span><span style=color:#f92672>?</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Imagine our agency <span style=color:#66d9ef>as</span> a buzzing beehive, <span style=color:#66d9ef>like</span> StackOverflow <span style=color:#66d9ef>on</span> steroids. We have a crazy number <span style=color:#66d9ef>of</span> cases popping up <span style=color:#66d9ef>every</span> <span style=color:#66d9ef>day</span>, <span style=color:#66d9ef>each</span> <span style=color:#66d9ef>with</span> a juicy bounty attached (yes, cold, hard cash<span style=color:#f92672>!</span>). <span style=color:#66d9ef>And</span> guess what<span style=color:#f92672>?</span> We<span style=color:#e6db74>&#39;ve got thousands of Kusto Detectives scattered across the globe, all itching to pick a case and earn their detective stripes. But here&#39;</span>s the catch: <span style=color:#66d9ef>only</span> the <span style=color:#66d9ef>first</span> detective <span style=color:#66d9ef>to</span> crack the <span style=color:#66d9ef>case</span> gets the bounty <span style=color:#66d9ef>and</span> major street cred<span style=color:#f92672>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>So, your mission, should you choose <span style=color:#66d9ef>to</span> accept it, <span style=color:#66d9ef>is</span> <span style=color:#66d9ef>to</span> dig <span style=color:#66d9ef>into</span> the vast archives <span style=color:#66d9ef>of</span> our <span style=color:#66d9ef>system</span> <span style=color:#66d9ef>operation</span> logs <span style=color:#66d9ef>from</span> the legendary <span style=color:#66d9ef>year</span> <span style=color:#ae81ff>2022</span>. You<span style=color:#e6db74>&#39;re on a quest to unearth the absolute legend, the detective with the biggest impact on our business—the one who raked in the most moolah by claiming bounties like a boss!
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Feeling a bit rusty or want to level up your Kusto skills? No worries, my friend. We&#39;</span>ve got your back <span style=color:#66d9ef>with</span> the <span style=color:#e6db74>&#34;Train Me&#34;</span> section. It<span style=color:#e6db74>&#39;s like a power-up that&#39;</span>ll help you sharpen your Kusto<span style=color:#f92672>-</span>fu <span style=color:#66d9ef>to</span> tackle <span style=color:#66d9ef>each</span> <span style=color:#66d9ef>case</span> head<span style=color:#f92672>-</span><span style=color:#66d9ef>on</span>. Oh, <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>if</span> you stumble upon a mind<span style=color:#f92672>-</span>boggling <span style=color:#66d9ef>case</span> <span style=color:#66d9ef>and</span> need a little nudge, the <span style=color:#e6db74>&#34;Hints&#34;</span> <span style=color:#66d9ef>are</span> there <span style=color:#66d9ef>to</span> save the <span style=color:#66d9ef>day</span><span style=color:#f92672>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Now, strap <span style=color:#66d9ef>on</span> your detective hat, embrace the thrill, <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>get</span> ready <span style=color:#66d9ef>to</span> rock this investigation. The fate <span style=color:#66d9ef>of</span> the <span style=color:#e6db74>&#34;Most Epic Detective of the Year&#34;</span> rests <span style=color:#66d9ef>in</span> your hands<span style=color:#f92672>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Good luck, rookie, <span style=color:#66d9ef>and</span> remember <span style=color:#66d9ef>to</span> bring your sense <span style=color:#66d9ef>of</span> humor along <span style=color:#66d9ef>for</span> this wild ride<span style=color:#f92672>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Lieutenant Laughter
</span></span></code></pre></div></div></div></div></div></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#achievements>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:rgfsa1+web@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>rgfsa1+web@gmail.com</span></a></li><li><a href=https://github.com/pawnmuncher target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>pawnmuncher</span></a></li><li><a href=https://www.linkedin.com/in/cyber-consultant target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>M Harrison</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.3c639bb2b0f116a3f46cae25e8a71257ede12e85182a5a923d0bca7065bf5b6b.js integrity="sha256-PGObsrDxFqP0bK4l6KcSV+3hLoUYKlqSPQvKcGW/W2s=" defer></script></body></html>