<!doctype html><html lang=en><head><title>KQL Notes</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/application.8718ac40dd62412c66b7087b7fad0eb3ad546c79e3a460bfb87777981964dc9d.css integrity="sha256-hxisQN1iQSxmtwh7f60Os61UbHnjpGC/uHd3mBlk3J0="><link rel=icon type=image/png href=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png><meta property="og:title" content="KQL Notes"><meta property="og:description" content="https://detective.kusto.io/inbox
Season 2 - Case 2 - Catch the Phishermen! // Training //Get the schema, know what we are working with PhoneCalls | getschema //see how big a data set PhoneCalls | count //see some example data PhoneCalls | take 100 //parse &#34;out&#34; the json data using dotNotation so we can use it to filter PhoneCalls | where EventType == 'Connect' | extend Origin=tostring(Properties.Origin), Destination=tostring(Properties.Destination), Hidden=tobool(Properties.IsHidden) | take 10 //Test 1 using parsed json as filters PhoneCalls | where EventType == 'Connect' | where tobool(Properties."><meta property="og:type" content="article"><meta property="og:url" content="https://www.mjh3.com/notes/kql/"><meta property="article:section" content="notes"><meta name=twitter:card content="summary"><meta name=twitter:title content="KQL Notes"><meta name=twitter:description content="https://detective.kusto.io/inbox
Season 2 - Case 2 - Catch the Phishermen! // Training //Get the schema, know what we are working with PhoneCalls | getschema //see how big a data set PhoneCalls | count //see some example data PhoneCalls | take 100 //parse &#34;out&#34; the json data using dotNotation so we can use it to filter PhoneCalls | where EventType == 'Connect' | extend Origin=tostring(Properties.Origin), Destination=tostring(Properties.Destination), Hidden=tobool(Properties.IsHidden) | take 10 //Test 1 using parsed json as filters PhoneCalls | where EventType == 'Connect' | where tobool(Properties."></head><body class="type-notes kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png alt=Logo>
Maron's Site</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/sections/skills/Azure_hu600355f1fa58a54f1c890f6883db002d_5321_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/notes data-filter=all>Notes</a></li><div class=subtree><li><a class=active href=/notes/kql/ title=KQL>KQL</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class="content container-fluid" id=content><div class="container-fluid note-card-holder" id=note-card-holder><p><a href=https://detective.kusto.io/inbox target=_blank rel=noopener>https://detective.kusto.io/inbox</a></p><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 2 - Catch the Phishermen!</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#f92672>//</span> Training
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Get</span> the <span style=color:#66d9ef>schema</span>, know what we <span style=color:#66d9ef>are</span> working <span style=color:#66d9ef>with</span>
</span></span><span style=display:flex><span>PhoneCalls
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> getschema
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>see how big a <span style=color:#66d9ef>data</span> <span style=color:#66d9ef>set</span>
</span></span><span style=display:flex><span>PhoneCalls
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>see <span style=color:#66d9ef>some</span> example <span style=color:#66d9ef>data</span>
</span></span><span style=display:flex><span>PhoneCalls
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>parse <span style=color:#e6db74>&#34;out&#34;</span> the json <span style=color:#66d9ef>data</span> <span style=color:#66d9ef>using</span> dotNotation so we can use it <span style=color:#66d9ef>to</span> filter
</span></span><span style=display:flex><span>PhoneCalls 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Connect&#39;</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend Origin<span style=color:#f92672>=</span>tostring(Properties.Origin), Destination<span style=color:#f92672>=</span>tostring(Properties.Destination), Hidden<span style=color:#f92672>=</span>tobool(Properties.IsHidden) 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Test <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>using</span> parsed json <span style=color:#66d9ef>as</span> filters
</span></span><span style=display:flex><span>PhoneCalls 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Connect&#39;</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> tobool(Properties.IsHidden) <span style=color:#f92672>==</span> <span style=color:#66d9ef>false</span> <span style=color:#66d9ef>or</span> Properties <span style=color:#f92672>!</span>has <span style=color:#e6db74>&#39;IsHidden&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>Count</span><span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> Phone<span style=color:#f92672>=</span>tostring(Properties.Origin) 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Count</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Perform <span style=color:#66d9ef>some</span> <span style=color:#66d9ef>statistics</span>
</span></span><span style=display:flex><span>PhoneCalls 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span><span style=color:#e6db74>&#39;Connect&#39;</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize calls<span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>h) 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>avg</span>(calls), percentile(calls, <span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Use <span style=color:#66d9ef>join</span> 
</span></span><span style=display:flex><span>PhoneCalls 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Connect&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> Properties.Destination <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;0&#39;</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span>
</span></span><span style=display:flex><span>    (PhoneCalls
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Disconnect&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend DisconnectProperties <span style=color:#f92672>=</span> Properties) 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>on</span> CallConnectionId 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> DisconnectProperties.DisconnectedBy <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Destination&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Solution
</span></span><span style=display:flex><span>PhoneCalls 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Connect&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend Origin<span style=color:#f92672>=</span>tostring(Properties.Origin), Destination<span style=color:#f92672>=</span>tostring(Properties.Destination)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> Properties has <span style=color:#e6db74>&#39;IsHidden&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span>
</span></span><span style=display:flex><span>    (PhoneCalls
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Disconnect&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend DisconnectedBy <span style=color:#f92672>=</span> tostring(Properties.DisconnectedBy)
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> DisconnectedBy <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Destination&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>on</span> CallConnectionId 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize PerpNumber <span style=color:#f92672>=</span> dcount(Destination) <span style=color:#66d9ef>by</span> Origin
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> PerpNumber
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 1 - To bill or not to bill?</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>1</span> training
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>can run <span style=color:#66d9ef>sql</span> directly
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>SUM</span>(Consumed <span style=color:#f92672>*</span> Cost) <span style=color:#66d9ef>AS</span> TotalCost 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Costs 
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> Consumption <span style=color:#66d9ef>ON</span> Costs.MeterType <span style=color:#f92672>=</span> Consumption.MeterType 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>can use <span style=color:#66d9ef>EXPLAIN</span> <span style=color:#66d9ef>to</span> <span style=color:#66d9ef>convert</span> <span style=color:#66d9ef>to</span> KQL
</span></span><span style=display:flex><span><span style=color:#66d9ef>EXPLAIN</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>SUM</span>(Consumed <span style=color:#f92672>*</span> Cost) <span style=color:#66d9ef>AS</span> TotalCost 
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Costs 
</span></span><span style=display:flex><span><span style=color:#66d9ef>JOIN</span> Consumption <span style=color:#66d9ef>ON</span> Costs.MeterType <span style=color:#f92672>=</span> Consumption.MeterType 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>from</span> <span style=color:#66d9ef>EXPLAIN</span>
</span></span><span style=display:flex><span>Costs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> 
</span></span><span style=display:flex><span>(Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project<span style=color:#f92672>-</span><span style=color:#66d9ef>rename</span> [<span style=color:#e6db74>&#39;Consumption.MeterType&#39;</span>]<span style=color:#f92672>=</span>MeterType) <span style=color:#66d9ef>on</span> ([<span style=color:#e6db74>&#39;$left&#39;</span>].MeterType <span style=color:#f92672>==</span> [<span style=color:#e6db74>&#39;$right&#39;</span>].[<span style=color:#e6db74>&#39;Consumption.MeterType&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize TotalCost<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(__sql_multiply(Consumed, Cost))
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project TotalCost
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>cleaned up a bit USES LOOKUP
</span></span><span style=display:flex><span>Consumption  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> summarize TotalConsumed <span style=color:#f92672>=</span> <span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> MeterType  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> lookup Costs <span style=color:#66d9ef>on</span> MeterType  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> extend TotalCost <span style=color:#f92672>=</span> TotalConsumed<span style=color:#f92672>*</span>Cost  
</span></span><span style=display:flex><span> <span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>sum</span>(TotalCost) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> who used the most water
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Water&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>summarize WaterWaster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> HouseholdId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> WaterWaster
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>who used the most electricity
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Electricity&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize ElectricityWaster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> HouseholdId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> ElectricityWaster
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Water consumption <span style=color:#66d9ef>by</span> date <span style=color:#66d9ef>Timestamp</span>
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Water&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize WaterWaster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>d)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> render timechart 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Electricity <span style=color:#66d9ef>by</span> date
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Electricity&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Elec_Waster<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(Consumed) <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>d)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> render timechart 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Elec stats <span style=color:#66d9ef>like</span> <span style=color:#66d9ef>min</span> <span style=color:#66d9ef>max</span> <span style=color:#66d9ef>count</span> <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>avg</span>
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> MeterType <span style=color:#f92672>==</span><span style=color:#e6db74>&#34;Electricity&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Total_Count<span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>(), Lowest_Value<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(Consumed), Highest_Value<span style=color:#f92672>=</span><span style=color:#66d9ef>max</span>(Consumed), Average_Value<span style=color:#f92672>=</span><span style=color:#66d9ef>avg</span>(Consumed)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> Solved
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize hint.strategy<span style=color:#f92672>=</span>shuffle arg_max(Consumed, <span style=color:#f92672>*</span>) <span style=color:#66d9ef>by</span> HouseholdId, MeterType, <span style=color:#66d9ef>Timestamp</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> (
</span></span><span style=display:flex><span>    Costs
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> project MeterType, Cost
</span></span><span style=display:flex><span>) <span style=color:#66d9ef>on</span> MeterType
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend BillAmount <span style=color:#f92672>=</span> Consumed <span style=color:#f92672>*</span> Cost
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize TotalBillsAmount <span style=color:#f92672>=</span> <span style=color:#66d9ef>sum</span>(BillAmount)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>using</span> lookup <span style=color:#66d9ef>function</span>
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize hint.strategy<span style=color:#f92672>=</span>shuffle arg_max(Consumed, <span style=color:#f92672>*</span>) <span style=color:#66d9ef>by</span> HouseholdId, MeterType, <span style=color:#66d9ef>Timestamp</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> lookup Costs <span style=color:#66d9ef>on</span> MeterType
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>sum</span>(Consumed <span style=color:#f92672>*</span> Cost)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Even cleaner <span style=color:#66d9ef>using</span> the <span style=color:#66d9ef>DISTINCT</span> <span style=color:#66d9ef>function</span>
</span></span><span style=display:flex><span>Consumption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>distinct</span> Consumed, HouseholdId, MeterType, <span style=color:#66d9ef>Timestamp</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> lookup Costs <span style=color:#66d9ef>on</span> MeterType
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize round(<span style=color:#66d9ef>sum</span>(Consumed <span style=color:#f92672>*</span> Cost),<span style=color:#ae81ff>2</span>)
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Kusto Detective KQL Challenge Information</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-MD data-lang=MD><span style=display:flex><span><span style=color:#75715e>## Welcome to the Kusto Detective Agency - Season 2!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Here you can find my solutions for Season 2.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Feel free to reach out if you have any questions.
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 0 - Onboarding</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>0</span> training
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend Bounty <span style=color:#f92672>=</span> toreal(Properties.Bounty)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseSolved&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize CasesSolved<span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> DetectiveId
</span></span><span style=display:flex><span><span style=color:#f92672>//|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> CasesSolved
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseOpened <span style=color:#f92672>=</span> <span style=color:#66d9ef>Timestamp</span>, CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> 
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseAssigned&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize FirstAssigned<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(<span style=color:#66d9ef>Timestamp</span>) <span style=color:#66d9ef>by</span> CaseId)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Average<span style=color:#f92672>=</span><span style=color:#66d9ef>avg</span>(FirstAssigned <span style=color:#f92672>-</span> CaseOpened)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseOpened <span style=color:#f92672>=</span> <span style=color:#66d9ef>Timestamp</span>, CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> 
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseSolved&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize CaseSolved<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(<span style=color:#66d9ef>Timestamp</span>) <span style=color:#66d9ef>by</span> CaseId)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Average<span style=color:#f92672>=</span><span style=color:#66d9ef>avg</span>(CaseSolved <span style=color:#f92672>-</span> CaseOpened)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseOpened&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseOpened<span style=color:#f92672>=</span><span style=color:#66d9ef>Timestamp</span>, CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;CaseSolved&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize CaseSolved<span style=color:#f92672>=</span><span style=color:#66d9ef>min</span>(<span style=color:#66d9ef>Timestamp</span>) <span style=color:#66d9ef>by</span> CaseId
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>avg</span>(CaseSolved <span style=color:#f92672>-</span> CaseOpened)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>Case</span> <span style=color:#ae81ff>0</span> Solved
</span></span><span style=display:flex><span>DetectiveCases
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>Timestamp</span> <span style=color:#f92672>&gt;=</span> datetime(<span style=color:#ae81ff>2022</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span>) <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>Timestamp</span> <span style=color:#f92672>&lt;</span> datetime(<span style=color:#ae81ff>2023</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;CaseOpened&#34;</span> <span style=color:#66d9ef>and</span> isnotnull(Properties.Bounty) <span style=color:#66d9ef>and</span> isnotnull(CaseId)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project CaseId, Bounty <span style=color:#f92672>=</span> todouble(parse_json(Properties).Bounty)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> (
</span></span><span style=display:flex><span>    DetectiveCases
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> EventType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;CaseAssigned&#34;</span> <span style=color:#66d9ef>and</span> isnotnull(DetectiveId) <span style=color:#66d9ef>and</span> isnotnull(CaseId)
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> project CaseId, DetectiveId
</span></span><span style=display:flex><span>) <span style=color:#66d9ef>on</span> CaseId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize TotalEarnings <span style=color:#f92672>=</span> <span style=color:#66d9ef>sum</span>(Bounty) <span style=color:#66d9ef>by</span> DetectiveId
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>10</span> <span style=color:#66d9ef>by</span> TotalEarnings <span style=color:#66d9ef>desc</span>
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 3 - Return Stolen Cars!</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#f92672>//</span> Records <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span>CarsTraffic
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> See <span style=color:#66d9ef>some</span> examples
</span></span><span style=display:flex><span>CarsTraffic
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>100</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> Records <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span>StolenCars
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>See <span style=color:#66d9ef>some</span> examples
</span></span><span style=display:flex><span>StolenCars
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>100</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> find <span style=color:#66d9ef>all</span> <span style=color:#66d9ef>rows</span> that have one <span style=color:#66d9ef>of</span> a list <span style=color:#66d9ef>of</span> VIN numbers
</span></span><span style=display:flex><span>CarsTraffic 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> VIN <span style=color:#66d9ef>in</span> (<span style=color:#e6db74>&#39;FD655964S&#39;</span>, <span style=color:#e6db74>&#39;JO132865F&#39;</span>, <span style=color:#e6db74>&#39;AD701526K&#39;</span>) 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>the stolen car <span style=color:#66d9ef>with</span> the most sightings
</span></span><span style=display:flex><span>CarsTraffic 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> VIN <span style=color:#66d9ef>in</span> (StolenCars) 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Sightings<span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> VIN 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> Sightings
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>which were the <span style=color:#66d9ef>first</span> <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>last</span> cars <span style=color:#66d9ef>to</span> be spotted <span style=color:#66d9ef>at</span> a certain intersection
</span></span><span style=display:flex><span>CarsTraffic 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> Street <span style=color:#f92672>==</span> <span style=color:#ae81ff>180</span> <span style=color:#66d9ef>and</span> Ave <span style=color:#f92672>==</span> <span style=color:#ae81ff>121</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>First</span><span style=color:#f92672>=</span>arg_min(<span style=color:#66d9ef>Timestamp</span>, VIN), <span style=color:#66d9ef>Last</span><span style=color:#f92672>=</span>arg_max(<span style=color:#66d9ef>Timestamp</span>, VIN)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>the street <span style=color:#66d9ef>and</span> avenue was stolen car <span style=color:#66d9ef>with</span> VIN number IR177866Y <span style=color:#66d9ef>first</span> sighted
</span></span><span style=display:flex><span>CarsTraffic 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> VIN <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;IR177866Y&#39;</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>First</span><span style=color:#f92672>=</span>arg_min(<span style=color:#66d9ef>Timestamp</span>, Street, Ave)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>find <span style=color:#66d9ef>all</span> cars that were <span style=color:#66d9ef>on</span> the same street <span style=color:#66d9ef>at</span> a certain time <span style=color:#66d9ef>in</span> <span style=color:#66d9ef>both</span> the morning <span style=color:#66d9ef>and</span> evening <span style=color:#66d9ef>of</span> June <span style=color:#ae81ff>14</span>
</span></span><span style=display:flex><span>CarsTraffic
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>Timestamp</span> <span style=color:#66d9ef>between</span> (datetime(<span style=color:#ae81ff>2023</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>14</span> <span style=color:#ae81ff>08</span>:<span style=color:#ae81ff>00</span>) .. <span style=color:#ae81ff>1</span>h)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind <span style=color:#f92672>=</span> <span style=color:#66d9ef>inner</span> (
</span></span><span style=display:flex><span>    CarsTraffic
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>Timestamp</span> <span style=color:#66d9ef>between</span> (datetime(<span style=color:#ae81ff>2023</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>14</span> <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>00</span>) .. <span style=color:#ae81ff>1</span>h)
</span></span><span style=display:flex><span>    ) <span style=color:#66d9ef>on</span> VIN, Street, Ave
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize dcount(VIN)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>cars have been <span style=color:#66d9ef>at</span> Street <span style=color:#ae81ff>228</span>, Ave <span style=color:#ae81ff>145</span> but have never been sighted <span style=color:#66d9ef>at</span> <span style=color:#66d9ef>location</span> Street <span style=color:#ae81ff>121</span>, Ave <span style=color:#ae81ff>180</span>
</span></span><span style=display:flex><span>CarsTraffic 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> Street <span style=color:#f92672>==</span> <span style=color:#ae81ff>228</span> <span style=color:#66d9ef>and</span> Ave <span style=color:#f92672>==</span> <span style=color:#ae81ff>145</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span>leftanti (
</span></span><span style=display:flex><span>    CarsTraffic <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> Street <span style=color:#f92672>==</span> <span style=color:#ae81ff>121</span> <span style=color:#66d9ef>and</span> Ave <span style=color:#f92672>==</span> <span style=color:#ae81ff>180</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>distinct</span> VIN) <span style=color:#66d9ef>on</span> VIN 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>distinct</span> VIN 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>create</span> the joined <span style=color:#66d9ef>data</span> <span style=color:#66d9ef>to</span> find the stash house <span style=color:#66d9ef>for</span> the stolen cars
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>last</span> seen <span style=color:#66d9ef>location</span> <span style=color:#66d9ef>for</span> stolen cars
</span></span><span style=display:flex><span>let VinsbyLocation <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    StolenCars
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> (CarsTraffic) <span style=color:#66d9ef>on</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>left</span>.VIN <span style=color:#f92672>==</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#66d9ef>right</span>.VIN
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize arg_max(<span style=color:#66d9ef>Timestamp</span>, Ave, Street) <span style=color:#66d9ef>by</span> VIN
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend TimeKey <span style=color:#f92672>=</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>15</span>m)
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> project TimeKey, Ave, Street;
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>all</span> VIN <span style=color:#66d9ef>at</span> the same <span style=color:#66d9ef>location</span> within <span style=color:#ae81ff>15</span> time window
</span></span><span style=display:flex><span>let VinsbyTime <span style=color:#f92672>=</span> VinsbyLocation
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> ( CarsTraffic <span style=color:#f92672>|</span> extend TimeKey <span style=color:#f92672>=</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>15</span>m)) <span style=color:#66d9ef>on</span> TimeKey, Ave, Street
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>by</span> VIN;
</span></span><span style=display:flex><span><span style=color:#f92672>//</span><span style=color:#66d9ef>last</span> sighting <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>each</span> vin <span style=color:#66d9ef>and</span> most visited.  The top two <span style=color:#66d9ef>are</span> <span style=color:#66d9ef>where</span> the plates were swapped
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>the <span style=color:#66d9ef>next</span> <span style=color:#66d9ef>is</span> the stash spot
</span></span><span style=display:flex><span>VinsbyTime
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> ( CarsTraffic <span style=color:#f92672>|</span> summarize arg_max(<span style=color:#66d9ef>Timestamp</span>, Ave, Street) <span style=color:#66d9ef>by</span> VIN ) <span style=color:#66d9ef>on</span> VIN
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> Ave, Street
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> count_ <span style=color:#66d9ef>desc</span>
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 4 - Triple trouble!</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#f92672>//</span> Triple trouble
</span></span><span style=display:flex><span>NetworkMetrics  
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> getschema 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>//|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IpInfo
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> getschema 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>IpInfo
</span></span><span style=display:flex><span><span style=color:#f92672>//|</span> <span style=color:#66d9ef>count</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>bin <span style=color:#66d9ef>function</span> <span style=color:#66d9ef>to</span> <span style=color:#66d9ef>create</span> buckets <span style=color:#66d9ef>of</span> time
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>d)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> render timechart
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> You can use time<span style=color:#f92672>-</span>chart <span style=color:#66d9ef>to</span> look <span style=color:#66d9ef>on</span> the <span style=color:#66d9ef>data</span>
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>avg</span>(BytesSent) <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>d)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> render timechart
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> .. <span style=color:#66d9ef>or</span> you can use query <span style=color:#66d9ef>to</span> calculate it
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>avg</span>(BytesSent) <span style=color:#66d9ef>by</span> bin(<span style=color:#66d9ef>Timestamp</span>, <span style=color:#ae81ff>1</span>d)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> avg_BytesSent <span style=color:#66d9ef>asc</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> evaluate ipv4_lookup(IpInfo, ClientIP, IpCidr)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>Which company most frequently contacted IP address <span style=color:#ae81ff>178</span>.<span style=color:#ae81ff>248</span>.<span style=color:#ae81ff>55</span>.<span style=color:#ae81ff>129</span>
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> TargetIP <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;178.248.55.129&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> evaluate ipv4_lookup(IpInfo, ClientIP, IpCidr)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>Count</span><span style=color:#f92672>=</span><span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> Info
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Count</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>The following query creates two series (<span style=color:#66d9ef>as</span> two columns): one <span style=color:#66d9ef>with</span> the number <span style=color:#66d9ef>of</span> records per <span style=color:#66d9ef>day</span> <span style=color:#66d9ef>and</span> the other <span style=color:#66d9ef>with</span> the average amount <span style=color:#66d9ef>of</span> <span style=color:#66d9ef>data</span> received per <span style=color:#66d9ef>day</span>.
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> make<span style=color:#f92672>-</span>series <span style=color:#66d9ef>count</span>(), <span style=color:#66d9ef>avg</span>(BytesReceived) <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>Timestamp</span> step <span style=color:#ae81ff>1</span>d
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> render timechart <span style=color:#66d9ef>with</span> (ysplit<span style=color:#f92672>=</span>panels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>I suspect that someone has hacked <span style=color:#66d9ef>into</span> the Digitown municipality <span style=color:#66d9ef>system</span> <span style=color:#66d9ef>and</span> stolen these documents.
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> Our <span style=color:#66d9ef>system</span> <span style=color:#66d9ef>is</span> a known <span style=color:#66d9ef>data</span> hub <span style=color:#66d9ef>and</span> hosts various information about the town itself, real<span style=color:#f92672>-</span>time monitoring 
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> systems <span style=color:#66d9ef>of</span> the city, tax payments, etc. 
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> It serves <span style=color:#66d9ef>as</span> a real<span style=color:#f92672>-</span>time <span style=color:#66d9ef>data</span> provider <span style=color:#66d9ef>to</span> many organizations around the world, so it receives a lot <span style=color:#66d9ef>of</span> traffic.
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> Unfortunately, I dont have much <span style=color:#66d9ef>data</span> <span style=color:#66d9ef>to</span> give you. 
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> <span style=color:#66d9ef>All</span> I have <span style=color:#66d9ef>is</span> a <span style=color:#ae81ff>30</span><span style=color:#66d9ef>day</span> traffic <span style=color:#66d9ef>statistics</span> report captured <span style=color:#66d9ef>by</span> the Digitown municipality <span style=color:#66d9ef>system</span> network routers
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>let sus <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize dcount(TargetIP) <span style=color:#66d9ef>by</span> ClientIP
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> dcount_TargetIP <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>distinct</span> ClientIP
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> evaluate ipv4_lookup(IpInfo, ClientIP, IpCidr)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project ClientIP, Info;
</span></span><span style=display:flex><span>NetworkMetrics
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> lookup kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> sus <span style=color:#66d9ef>on</span> ClientIP
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> make<span style=color:#f92672>-</span>series BytesSent<span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(BytesSent) <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>Timestamp</span> step <span style=color:#ae81ff>1</span>d <span style=color:#66d9ef>by</span> Info
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend (flag, score, baseline) <span style=color:#f92672>=</span> series_decompose_anomalies(BytesSent)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend top_sus <span style=color:#f92672>=</span> toreal(series_stats_dynamic(score)[<span style=color:#e6db74>&#39;max&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>by</span> top_sus
</span></span></code></pre></div></div></div></div></div><div class=note-card><div class=item><h5 class=note-title><span>Season 2 - Case 5 - El Puente is back!</span></h5><div class=card><div class=card-body><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>//|</span> getschema 
</span></span><span style=display:flex><span><span style=color:#f92672>//|</span> take <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>count</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span>
</span></span><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> TransactionType <span style=color:#e6db74>&#34; blob transaction:&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>distinct</span> TransactionType
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> <span style=color:#e6db74>&#34;Read blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39; read access (&#34;</span> ReadCount:long <span style=color:#e6db74>&#34; reads) were detected on the origin&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Read blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39; read access (&#34;</span> ReadCount:long <span style=color:#e6db74>&#34; reads) were detected&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>sum</span>(ReadCount) <span style=color:#66d9ef>by</span> BlobURI
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> sum_ReadCount
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> TransactionType <span style=color:#e6db74>&#34; blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend Details <span style=color:#f92672>=</span> parse_url(BlobURI)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> project EventText, BlobURI, Details
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> take <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> TransactionType <span style=color:#e6db74>&#34; blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend Details <span style=color:#f92672>=</span> parse_url(BlobURI)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend <span style=color:#66d9ef>Host</span><span style=color:#f92672>=</span>tostring(Details.<span style=color:#66d9ef>Host</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> TransactionType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Delete&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Host</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> count_
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> <span style=color:#66d9ef>Using</span> conditional aggregates
</span></span><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> TransactionType <span style=color:#e6db74>&#34; blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> <span style=color:#f92672>*</span> <span style=color:#e6db74>&#34;(&#34;</span> <span style=color:#66d9ef>Reads</span>:long <span style=color:#e6db74>&#34;reads)&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend <span style=color:#66d9ef>Host</span> <span style=color:#f92672>=</span> tostring(parse_url(BlobURI).<span style=color:#66d9ef>Host</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize Deletes<span style=color:#f92672>=</span>countif(TransactionType  <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Delete&#39;</span>), 
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Reads</span><span style=color:#f92672>=</span>sumif(<span style=color:#66d9ef>Reads</span>, TransactionType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Read&#39;</span>) <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Host</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Reads</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> <span style=color:#66d9ef>Using</span> <span style=color:#66d9ef>join</span> <span style=color:#f92672>-</span> requires double<span style=color:#f92672>-</span>pass over the <span style=color:#66d9ef>data</span>, so it works slower
</span></span><span style=display:flex><span>let ParsedData<span style=color:#f92672>=</span>StorageArchiveLogs
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> TransactionType <span style=color:#e6db74>&#34; blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend <span style=color:#66d9ef>Host</span> <span style=color:#f92672>=</span> tostring(parse_url(BlobURI).<span style=color:#66d9ef>Host</span>);
</span></span><span style=display:flex><span>ParsedData
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> TransactionType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Read&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> <span style=color:#f92672>*</span> <span style=color:#e6db74>&#34;(&#34;</span> <span style=color:#66d9ef>Reads</span>:long <span style=color:#e6db74>&#34;reads)&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>Reads</span><span style=color:#f92672>=</span><span style=color:#66d9ef>sum</span>(<span style=color:#66d9ef>Reads</span>) <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Host</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>join</span> kind<span style=color:#f92672>=</span><span style=color:#66d9ef>inner</span> 
</span></span><span style=display:flex><span>    (
</span></span><span style=display:flex><span>    ParsedData
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> TransactionType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Delete&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize <span style=color:#66d9ef>count</span>() <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Host</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>Host</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> top <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Reads</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>let sus <span style=color:#f92672>=</span> StorageArchiveLogs
</span></span><span style=display:flex><span>    <span style=color:#f92672>//</span>parse blob <span style=color:#66d9ef>data</span> nd <span style=color:#66d9ef>get</span> <span style=color:#66d9ef>all</span> <span style=color:#66d9ef>host</span> <span style=color:#66d9ef>and</span> path <span style=color:#66d9ef>values</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> TransactionType <span style=color:#e6db74>&#34; blob transaction:&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> <span style=color:#f92672>*</span> <span style=color:#e6db74>&#34;blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> <span style=color:#f92672>*</span> <span style=color:#e6db74>&#34;read access (&#34;</span> ReadCount: long <span style=color:#e6db74>&#34; reads)&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend <span style=color:#66d9ef>All</span> <span style=color:#f92672>=</span> parse_url(BlobURI)
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend <span style=color:#66d9ef>Host</span> <span style=color:#f92672>=</span> tostring(<span style=color:#66d9ef>All</span>.<span style=color:#66d9ef>Host</span>)
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend Path <span style=color:#f92672>=</span> tostring(<span style=color:#66d9ef>All</span>.Path)
</span></span><span style=display:flex><span>    <span style=color:#f92672>//</span>define published time <span style=color:#66d9ef>from</span> <span style=color:#66d9ef>create</span> records deleted time <span style=color:#66d9ef>from</span> <span style=color:#66d9ef>delete</span> records
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> summarize
</span></span><span style=display:flex><span>        published <span style=color:#f92672>=</span> minif(<span style=color:#66d9ef>Timestamp</span>, TransactionType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Create&#39;</span>)
</span></span><span style=display:flex><span>        , deleted <span style=color:#f92672>=</span> minif(<span style=color:#66d9ef>Timestamp</span>, TransactionType <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Delete&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>by</span> <span style=color:#66d9ef>Host</span>, Path
</span></span><span style=display:flex><span>    <span style=color:#f92672>//</span>look <span style=color:#66d9ef>for</span> deletes that followed a <span style=color:#66d9ef>create</span> within <span style=color:#ae81ff>30</span> <span style=color:#66d9ef>min</span> window
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> extend lifespan <span style=color:#f92672>=</span> deleted <span style=color:#f92672>-</span> published
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> lifespan <span style=color:#f92672>&lt;</span> timespan(<span style=color:#ae81ff>30</span>m)
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span> project Path;
</span></span><span style=display:flex><span>StorageArchiveLogs
</span></span><span style=display:flex><span><span style=color:#f92672>//</span> <span style=color:#66d9ef>get</span> the Event Text <span style=color:#66d9ef>and</span> project EventText Blob URI <span style=color:#66d9ef>All</span> Path 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> parse EventText <span style=color:#66d9ef>with</span> <span style=color:#f92672>*</span> <span style=color:#e6db74>&#34;blob transaction: &#39;&#34;</span> BlobURI <span style=color:#e6db74>&#34;&#39;&#34;</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend <span style=color:#66d9ef>All</span> <span style=color:#f92672>=</span> parse_url(BlobURI)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> extend Path <span style=color:#f92672>=</span> tostring(<span style=color:#66d9ef>All</span>.Path)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#66d9ef>where</span> Path <span style=color:#66d9ef>in</span> (sus)
</span></span></code></pre></div></div></div></div></div></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://www.mjh3.com#achievements>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto: target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span></span></a></li><li><a href=https://github.com/pawnmuncher target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>pawnmuncher</span></a></li><li><a href=https://www.linkedin.com/in/cyber-consultant target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>M Harrison</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center"> 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.654a6a2dd41b32cc7e147cbbfa5cd5cf8788a708680ea2b1d7b09060b0d744ca.js integrity="sha256-ZUpqLdQbMsx+FHy7+lzVz4eIpwhoDqKx17CQYLDXRMo=" defer></script></body></html>